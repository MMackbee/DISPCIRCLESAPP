{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import{collection,query,where,getDocs}from\"firebase/firestore\";import{db}from\"./firebase\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ImportHistory=_ref=>{let{user}=_ref;const[history,setHistory]=useState([]);useEffect(()=>{const fetchHistory=async()=>{if(!user)return;try{const q=query(collection(db,\"userData\"),where(\"uid\",\"==\",user.uid));const snapshot=await getDocs(q);const batches={};snapshot.forEach(doc=>{const data=doc.data();const batchId=data.batchId;if(!batches[batchId]){var _data$uploadedAt,_data$uploadedAt$toDa;batches[batchId]={notes:data.notes||\"No notes\",uploadedAt:((_data$uploadedAt=data.uploadedAt)===null||_data$uploadedAt===void 0?void 0:(_data$uploadedAt$toDa=_data$uploadedAt.toDate)===null||_data$uploadedAt$toDa===void 0?void 0:_data$uploadedAt$toDa.call(_data$uploadedAt))||new Date(),batchId,shotCount:0};}batches[batchId].shotCount+=1;});const sorted=Object.values(batches).sort((a,b)=>b.uploadedAt-a.uploadedAt);setHistory(sorted);}catch(err){console.error(\"‚ùå Failed to fetch history:\",err);}};fetchHistory();},[user]);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-900 text-white p-6 mt-6 rounded-lg max-w-xl mx-auto\",id:\"history\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold mb-4\",children:\"\\uD83D\\uDCDC Import History\"}),history.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"No previous uploads found.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3 text-sm\",children:history.map(entry=>/*#__PURE__*/_jsx(Link,{to:`/session/${entry.batchId}`,children:/*#__PURE__*/_jsxs(\"li\",{className:\"p-4 rounded bg-gray-800 hover:bg-gray-700 transition cursor-pointer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold\",children:[\"\\uD83D\\uDCDD \",entry.notes]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-400\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uD83D\\uDCC5 Date:\"}),\" \",entry.uploadedAt.toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-400\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uC0F7 (Shots):\"}),\" \",entry.shotCount]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-500 text-xs mt-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID:\"}),\" \",entry.batchId]})]})},entry.batchId))})]});};export default ImportHistory;","map":{"version":3,"names":["React","useEffect","useState","Link","collection","query","where","getDocs","db","jsx","_jsx","jsxs","_jsxs","ImportHistory","_ref","user","history","setHistory","fetchHistory","q","uid","snapshot","batches","forEach","doc","data","batchId","_data$uploadedAt","_data$uploadedAt$toDa","notes","uploadedAt","toDate","call","Date","shotCount","sorted","Object","values","sort","a","b","err","console","error","className","id","children","length","map","entry","to","toLocaleString"],"sources":["/Users/makelmackbee/dispcirclesapp/src/ImportHistory.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { collection, query, where, getDocs } from \"firebase/firestore\";\nimport { db } from \"./firebase\";\n\nconst ImportHistory = ({ user }) => {\n  const [history, setHistory] = useState([]);\n\n  useEffect(() => {\n    const fetchHistory = async () => {\n      if (!user) return;\n\n      try {\n        const q = query(collection(db, \"userData\"), where(\"uid\", \"==\", user.uid));\n        const snapshot = await getDocs(q);\n\n        const batches = {};\n        snapshot.forEach((doc) => {\n          const data = doc.data();\n          const batchId = data.batchId;\n          if (!batches[batchId]) {\n            batches[batchId] = {\n              notes: data.notes || \"No notes\",\n              uploadedAt: data.uploadedAt?.toDate?.() || new Date(),\n              batchId,\n              shotCount: 0,\n            };\n          }\n          batches[batchId].shotCount += 1;\n        });\n\n        const sorted = Object.values(batches).sort((a, b) => b.uploadedAt - a.uploadedAt);\n        setHistory(sorted);\n      } catch (err) {\n        console.error(\"‚ùå Failed to fetch history:\", err);\n      }\n    };\n\n    fetchHistory();\n  }, [user]);\n\n  return (\n    <div className=\"bg-gray-900 text-white p-6 mt-6 rounded-lg max-w-xl mx-auto\" id=\"history\">\n      <h3 className=\"text-lg font-bold mb-4\">üìú Import History</h3>\n\n      {history.length === 0 ? (\n        <p className=\"text-gray-400\">No previous uploads found.</p>\n      ) : (\n        <ul className=\"space-y-3 text-sm\">\n          {history.map((entry) => (\n            <Link to={`/session/${entry.batchId}`} key={entry.batchId}>\n              <li className=\"p-4 rounded bg-gray-800 hover:bg-gray-700 transition cursor-pointer\">\n                <div className=\"font-bold\">üìù {entry.notes}</div>\n                <div className=\"text-gray-400\"><strong>üìÖ Date:</strong> {entry.uploadedAt.toLocaleString()}</div>\n                <div className=\"text-gray-400\"><strong>ÏÉ∑ (Shots):</strong> {entry.shotCount}</div>\n                <div className=\"text-gray-500 text-xs mt-2\">\n                  <strong>ID:</strong> {entry.batchId}\n                </div>\n              </li>\n            </Link>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nexport default ImportHistory;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}